<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Simple table</title>
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<style>
    #main {
        margin-top: 150px;
        max-width: 700px;
    }

    .row {
        height: 60px;
    }

    .col {
        max-width: 60px;
        padding: 0;
    }

    .btn {

        border-radius: 0;
    }

    .grid-container>div {
        background-color: rgba(255, 255, 255, 0.8);
        text-align: center;
        padding: 20px 0;
    }
</style>

<script>
    $(document).ready(function () {
        var colClass = "col col-md border border-dark"
        var BUTTON_INFO = 'btn-info'
        var BUTTON_SUCCESS = 'btn-success'
        var BUTTON_DANGER = 'btn-danger'
        var BUTTON_DARK = 'btn-dark'
        var baseButtonClass = `btn ${BUTTON_INFO} h-100 w-100 d-block`
        var toggleValue = null
        var startClick = 0;
        var endClick = 0;
        var initGrid = 10;
        var newGrid = 10;
        var grid = [];
        var startingPoint = [];
        var endPoint = [];

        // Enable tooltips
        const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
        const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))

        buildGrid(initGrid)

        function buildGrid(size) {
            for (i = 0; i < size; i++) {
                var rowId = `row-${i}`
                $('#grid').append('<div class="row justify-content-md-center" id="' + rowId + '" />');
                grid[i] = [];
                for (j = 0; j < size; j++) {
                    var curVertex = `${i}-${j}`;

                    // Place Buttons in Grid
                    $(`#${rowId}`).append(`
                    <div class="${colClass}" id="${curVertex}" >
                        <button class="${i}-${j} ${baseButtonClass}" value="${curVertex}">
                        [${i},${j}]
                        </button>
                    </div>
                    `)

                    // Place Empty Values in each grid cell
                    grid[i][j] = 'Empty'

                    // Add Click handler to buttons
                    $(`.${i}-${j}`).click(function (e) {
                        e.preventDefault();
                        var targArray = e.target.value.split('-')
                        var [targRow, targCol] = [targArray[0], targArray[1]];
                        var curClass = $(this).attr("class");
                        if (toggleValue === '1') {
                            $(this).removeClass(`${curClass}`)
                            $(this).addClass('btn btn-dark h-100 w-100 d-block');
                            grid[targRow][targCol] = 'Obstacle'
                        }
                        if (toggleValue === '2' && startClick !== 1) {
                            startClick++;
                            $(this).removeClass(`${curClass}`)
                            $(this).addClass('btn btn-success h-100 w-100 d-block');
                            grid[targRow][targCol] = 'Start'
                            startingPoint = [Number(targRow), Number(targCol)]
                        }
                        if (toggleValue === '3' && endClick !== 1) {
                            endClick++;
                            $(this).removeClass(`${curClass}`)
                            $(this).addClass('btn btn-danger h-100 w-100 d-block');
                            grid[targRow][targCol] = 'End'
                            endPoint = [Number(targRow), Number(targCol)]
                        }

                    })
                }
            }
        }

        function locationStatus(location, gridElement) {
            var gSize = gridElement.length;
            const {distanceFromTop, distanceFromLeft} = location;
            var dft = distanceFromTop
                , dfl = distanceFromLeft
                ;

            if (distanceFromLeft < 0 ||
                distanceFromLeft >= gSize ||
                distanceFromTop < 0 ||
                distanceFromTop >= gSize) {
                return 'Invalid'
            }
            if (gridElement[dft][dfl] === 'End') {
                return 'Goal'
            }
            if (gridElement[dft][dfl] !== 'Empty') {
                return 'Blocked'
            }
            return 'Valid'
        }

        function exploreInDirection(currentLocation, direction, gridElement) {
            var newPath = currentLocation.path.slice()
                , dft = currentLocation.distanceFromTop
                , dfl = currentLocation.distanceFromLeft
                ;
            const {distanceFromTop, distanceFromLeft} = currentLocation;

            newPath.push({direction, coord: [dft, dfl]});

            if (direction === 'North') {
                dft -= 1;
            }
            if (direction === 'East') {
                dfl += 1;
            }
            if (direction === 'South') {
                dft += 1;
            }
            if (direction === 'West') {
                dfl -= 1;
            }

            var newLocation = {
                distanceFromTop: dft,
                distanceFromLeft: dfl,
                path: newPath,
                status: 'Unknown'
            }

            newLocation.status = locationStatus(newLocation, gridElement);

            if (newLocation.status === 'Valid') {
                gridElement[newLocation.distanceFromTop][newLocation.distanceFromLeft] = 'Visited'
            }

            return newLocation
        }

        function findShortestPath(startCoords, gridElement) {
            var distanceFromTop = startCoords[0]
                , distanceFromLeft = startCoords[1]
                ;

            var location = {
                distanceFromTop,
                distanceFromLeft,
                path: [],
                status: 'Start'
            }

            var queue = [location];

            while (queue.length > 0) {
                var currentLocation = queue.shift();

                //Explore North
                var newLocation = exploreInDirection(currentLocation, 'North', gridElement);

                if (newLocation.status === 'Goal') {
                    return newLocation.path;
                } else if (newLocation.status === 'Valid') {
                    queue.push(newLocation)
                }
                //Explore South
                var newLocation = exploreInDirection(currentLocation, 'South', gridElement);

                if (newLocation.status === 'Goal') {
                    return newLocation.path;
                } else if (newLocation.status === 'Valid') {
                    queue.push(newLocation)
                }

                //Explore East
                var newLocation = exploreInDirection(currentLocation, 'East', gridElement);

                if (newLocation.status === 'Goal') {
                    return newLocation.path;
                } else if (newLocation.status === 'Valid') {
                    queue.push(newLocation)
                }

                //Explore West
                var newLocation = exploreInDirection(currentLocation, 'West', gridElement);

                if (newLocation.status === 'Goal') {
                    return newLocation.path;
                } else if (newLocation.status === 'Valid') {
                    queue.push(newLocation)
                }
            }

            return -1;
        }

        function resetGrid() {
            $('#grid').empty();
            var curChecked = $('input:checked').attr('id');
            $(`#${curChecked}`).prop('checked', false)
            toggleValue = null;
            startClick = 0;
            endClick = 0;
        }

        $('.btn-check').click(function (e) {
            // e.preventDefault();
            toggleValue = e.target.value
        })

        $('#reset').click(function () {
            resetGrid();
            buildGrid(newGrid);
        })

        $('#path').click(function (e) {
            var shortestPath = findShortestPath(startingPoint, grid);
            if (shortestPath?.length || shortestPath !== -1) {
                shortestPath = shortestPath.map(path => path.coord);

                for (let k = 0; k < shortestPath.length; k++) {
                    var [coordX, coordY] = shortestPath[k];
                    $(`.${coordX}-${coordY}`).addClass('btn btn-warning h-100 w-100 d-block');
                }
            } else {
                alert("No viable path found")
            }
        })

        $("#subm").click(function (e) {
            e.preventDefault()
            // get all the inputs into an array.
            var $inputs = $('#gridSize:input');

            // not sure if you wanted this, but I thought I'd add it.
            // get an associative array of just the values.
            var values = {};
            $inputs.each(function () {
                values[this.name] = $(this).val();
            });

            var {gridSize} = values;

            newGrid = Number(gridSize);
            resetGrid();
            buildGrid(newGrid);



        });
    })
</script>

<body>
    <div class="container text-center bg-light p-4" id="main">
        <div class="container  my-2">
            <form id="grid-form">
                <div class="d-flex flex-row align-items-center justify-content-evenly">
                    <div class="col-4 form-floating mb-3">
                        <input type="text" class="form-control" id="gridSize" name="gridSize" placeholder="10">
                        <label for="gridSize">Select Grid Size</label>
                    </div>
                    <div class="col-4">
                        <button class="btn btn-primary mb-auto" type="button" id="subm">Draw Grid</button>
                    </div>
                </div>
            </form>


        </div>
        <div class="container my-2 text-center bg-light" id="buttons">


            <div class="row">
                <div class="btn-group mb-5" role="group" aria-label="Grid selection">
                    <input type="radio" class="btn-check value-btn" name="grid-sel" id="obstacles" value="1"
                        autocomplete="off">
                    <label class="btn btn-outline-dark mx-1" for="obstacles" data-bs-toggle="tooltip"
                        data-bs-placement="top" data-bs-title="Select obstacles">Select Obstacles</label>
                    <input type="radio" class="btn-check" name="grid-sel" id="start" value="2" autocomplete="off">
                    <label class="btn btn-outline-success mx-1" for="start" data-bs-toggle="tooltip"
                        data-bs-placement="top" data-bs-title="Select Starting Point">Select Start</label>
                    <input type="radio" class="btn-check" name="grid-sel" id="end" value="3" autocomplete="off">
                    <label class="btn btn-outline-danger mx-1" for="end" data-bs-toggle="tooltip"
                        data-bs-placement="top" data-bs-title="Select Ending Point">Select End</label>
                    <input type="radio" class="btn-check" name="grid-sel" id="reset" value="4" autocomplete="off">
                    <label class="btn btn-outline-warning mx-1" for="reset" data-bs-toggle="tooltip"
                        data-bs-placement="top" data-bs-title="Clear the Grid">Reset</label>
                    <input type="radio" class="btn-check" name="grid-sel" id="path" value="5" autocomplete="off">
                    <label class="btn btn-outline-secondary mx-1" for="path" data-bs-toggle="tooltip"
                        data-bs-placement="top" data-bs-title="Find the Shortest Path">Find Path</label>
                </div>
            </div>
        </div>
        <div class="container text-center bg-light" id="grid"></div>
    </div>
</body>

<script>
     // FIND EDGES ON THE CORNERS
                    // if (topLeft) {
                    //     g.addEdge(curVertex, `${i + 1}-${j}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i}-${j + 1}`)
                    // }
                    // if (topRight) {
                    //     g.addEdge(curVertex, `${i + 1}-${j}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i}-${j - 1}`)
                    // }
                    // if (bottomLeft) {
                    //     g.addEdge(curVertex, `${i - 1}-${j}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i}-${j + 1}`)
                    // }
                    // if (bottomRight) {
                    //     g.addEdge(curVertex, `${i - 1}-${j}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i}-${j - 1}`)
                    // }
                    // FIND EDGES ON THE TOP
                    // if (i === '0' && !(topLeft || topRight)) {
                    //     g.addEdge(curVertex, `${i}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j + 1}`)
                    // }
                    // FIND EDGES ON THE LEFT
                    // if (j === '0' && !bottomLeft) {
                    //     g.addEdge(curVertex, `${i - 1}-${j}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j + 1}`)
                    // }
                    // FIND EDGES ON THE RIGHT
                    // if (j === '9' && !bottomRight) {
                    //     g.addEdge(curVertex, `${i - 1}-${j}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j - 1}`)
                    // }
                    // FIND EDGES AT THE BOTTOM
                    // if (i === '9' && !(bottomLeft || bottomRight)) {
                    //     g.addEdge(curVertex, `${i}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j + 1}`)
                    // }
                    //FIND ALL OTHER EDGES
                    // if (inGrid) {
                    //     g.addEdge(curVertex, `${i - 1}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j}`)
                    //     g.addEdge(curVertex, `${i - 1}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j}`)
                    //     g.addEdge(curVertex, `${i + 1}-${j + 1}`)
                    //     g.addEdge(curVertex, `${i}-${j - 1}`)
                    //     g.addEdge(curVertex, `${i}-${j + 1}`)
                    // }
</script>

</html>